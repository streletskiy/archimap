<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ArchiMap</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.5.2/flowbite.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ["Manrope", "Segoe UI", "Roboto", "Arial", "sans-serif"]
          },
          colors: {
            brand: {
              ink: "#0F172A",
              mute: "#64748B",
              purple: "#5B62F0",
              coral: "#FF6B7F"
            }
          },
          boxShadow: {
            float: "0 20px 40px rgba(15, 23, 42, 0.12)",
            soft: "0 8px 20px rgba(15, 23, 42, 0.06)"
          }
        }
      }
    };
  </script>
  <link href="https://unpkg.com/maplibre-gl@5.1.0/dist/maplibre-gl.css" rel="stylesheet" />
  <style>
    .maplibregl-ctrl-group {
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.22);
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.06);
      overflow: hidden;
    }
    .maplibregl-ctrl button {
      background: rgba(255, 255, 255, 0.95);
    }
  </style>
</head>
<body class="font-sans text-brand-ink bg-slate-100">
  <div id="map" class="fixed inset-0"></div>

  <div class="fixed top-4 left-5 z-[905] sm:top-3 sm:left-3">
    <div class="select-none text-3xl font-extrabold tracking-tight text-black drop-shadow-sm sm:text-2xl">/archimap</div>
    <div id="filter-shell" class="mt-2 w-[240px] max-w-[calc(100vw-1.5rem)] rounded-xl border border-slate-300 bg-white/95 p-2 shadow-soft transition-all duration-200">
      <div id="filter-compact">
        <button id="filter-toggle-btn" type="button" class="inline-flex w-full items-center gap-2 rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-semibold text-slate-800 hover:bg-slate-50">
          <svg viewBox="0 0 512 512" width="14" height="14" aria-hidden="true" class="fill-current">
            <path d="M3.9 54.9C10.5 40.9 24.5 32 40 32l432 0c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9 320 448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6l0-79.1L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z"></path>
          </svg>
          Фильтр
        </button>
        <label for="labels-toggle" class="mt-2 inline-flex w-full cursor-pointer items-center justify-between rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-sm font-semibold text-slate-800 hover:bg-slate-50">
          <span class="leading-none">Показывать обозначения</span>
          <span class="relative inline-flex h-5 w-9 items-center">
            <input id="labels-toggle" type="checkbox" class="peer sr-only" checked />
            <span class="absolute inset-0 rounded-full bg-slate-300 transition peer-checked:bg-indigo-500"></span>
            <span class="absolute left-0.5 h-4 w-4 rounded-full bg-white shadow-sm transition peer-checked:translate-x-[14px]"></span>
          </span>
        </label>
      </div>
      <div id="filter-panel" class="hidden">
        <div class="mb-3 flex items-center justify-between">
          <h3 class="text-base font-extrabold text-slate-900">Фильтр OSM тегов</h3>
          <button id="filter-close-btn" type="button" class="inline-flex h-8 w-8 items-center justify-center rounded-lg text-slate-500 hover:bg-slate-100 hover:text-slate-900" aria-label="Закрыть">
            <svg class="h-3 w-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 12 12M13 1 1 13"/>
            </svg>
          </button>
        </div>
        <p class="mb-3 text-xs text-slate-600">Критерии применяются к тегам OSM у загруженных зданий.</p>
        <form id="filter-form" class="space-y-3">
          <div id="filter-rows" class="space-y-2"></div>
          <div class="flex items-center gap-2">
            <button id="filter-add-row-btn" type="button" class="rounded-lg border border-slate-300 bg-white px-2.5 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50">+ Критерий</button>
            <button id="filter-reset-btn" type="button" class="rounded-lg border border-slate-300 bg-white px-2.5 py-1.5 text-xs font-semibold text-slate-700 hover:bg-slate-50">Сброс</button>
          </div>
        </form>
        <p id="filter-status" class="mt-3 text-xs text-slate-600">Фильтр не активен.</p>
        <datalist id="filter-tag-keys"></datalist>
      </div>
    </div>
  </div>

  <button id="auth-fab" class="fixed left-6 bottom-6 z-[910] grid h-12 w-12 place-items-center rounded-xl border border-white/40 bg-gradient-to-br from-brand-purple to-indigo-400 text-white shadow-float transition hover:-translate-y-0.5 sm:left-3 sm:bottom-3" type="button" aria-label="Вход">
    <svg viewBox="0 0 512 512" width="18" height="18" aria-hidden="true" class="fill-current">
      <path d="M217.9 105.9L340.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L217.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1L32 320c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM352 416l64 0c17.7 0 32-14.3 32-32l0-256c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32s14.3-32 32-32l64 0c53 0 96 43 96 96l0 256c0 53-43 96-96 96l-64 0c-17.7 0-32-14.3-32-32s14.3-32 32-32z"></path>
    </svg>
  </button>

  <div id="building-modal" class="fixed inset-0 z-50 hidden pointer-events-none" aria-hidden="true">
    <div class="pointer-events-auto absolute inset-3 overflow-auto rounded-2xl border border-slate-200 bg-white shadow-float md:inset-y-4 md:right-4 md:left-auto md:w-[calc(50%-1rem)] lg:w-[46%]">
      <div class="sticky top-0 z-10 flex items-center justify-between border-b border-slate-200 bg-white/95 px-4 py-3 backdrop-blur md:px-5">
        <h2 class="text-xl font-extrabold text-slate-900 md:text-2xl">Информация о здании</h2>
        <button id="modal-close" class="flex h-10 w-10 items-center justify-center rounded-lg border border-gray-200 bg-white text-gray-500 hover:bg-gray-100 hover:text-gray-900" type="button" aria-label="Закрыть">
          <svg class="h-3 w-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 12 12M13 1 1 13"/>
          </svg>
        </button>
      </div>
      <div id="modal-content" class="px-4 pt-4 pb-5 md:px-5 md:pt-5 md:pb-6"></div>
    </div>
  </div>

  <div id="auth-modal" class="fixed inset-0 z-[1200] hidden h-full w-full overflow-y-auto overflow-x-hidden bg-slate-900/35 p-4 backdrop-blur-sm md:p-6" aria-hidden="true">
    <div class="relative mx-auto mt-20 w-full max-w-md max-h-full">
      <div class="relative rounded-xl bg-white shadow-xl">
        <div class="flex items-center justify-between rounded-t border-b p-4 md:p-5">
          <h3 class="text-xl font-semibold text-gray-900">Авторизация</h3>
          <button id="auth-modal-close" type="button" class="inline-flex h-8 w-8 items-center justify-center rounded-lg text-sm text-gray-400 hover:bg-gray-100 hover:text-gray-900" aria-label="Закрыть">
            <svg class="h-3 w-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 12 12M13 1 1 13"/>
            </svg>
          </button>
        </div>
        <div class="space-y-4 p-4 md:p-5">
          <form id="login-form" class="space-y-3">
            <input id="login-username" class="w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-indigo-500 focus:ring-indigo-500" placeholder="Логин" required />
            <input id="login-password" class="w-full rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 focus:border-indigo-500 focus:ring-indigo-500" type="password" placeholder="Пароль" required />
            <button class="w-full rounded-lg bg-indigo-600 px-5 py-2.5 text-center text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300" type="submit">Войти</button>
          </form>
          <p id="auth-status" class="text-sm text-gray-500"></p>
          <button id="logout-btn" class="hidden w-full rounded-lg bg-rose-500 px-5 py-2.5 text-center text-sm font-medium text-white hover:bg-rose-600 focus:outline-none focus:ring-4 focus:ring-rose-200" type="button">Выйти</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/maplibre-gl@5.1.0/dist/maplibre-gl.js"></script>
  <script src="/main.js"></script>
</body>
</html>
